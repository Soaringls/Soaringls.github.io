<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/website/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/website/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/website/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/website/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.dexter.cool","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":2,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="The content mainly reference from yongcongwang’s IMM PredictionThe Kalman filter which was published by R.E.Kalman in 1960, is a set of mathematical equations that provides an efficient computational">
<meta property="og:type" content="article">
<meta property="og:title" content="Introduction of Kalman Filter">
<meta property="og:url" content="http://blog.dexter.cool/2020/12/31/autonomous-kalman-filter/index.html">
<meta property="og:site_name" content="Notebook">
<meta property="og:description" content="The content mainly reference from yongcongwang’s IMM PredictionThe Kalman filter which was published by R.E.Kalman in 1960, is a set of mathematical equations that provides an efficient computational">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-12-31T11:22:23.000Z">
<meta property="article:modified_time" content="2021-01-08T06:20:19.801Z">
<meta property="article:author" content="Dexter">
<meta property="article:tag" content="algorithm">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.dexter.cool/2020/12/31/autonomous-kalman-filter/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Introduction of Kalman Filter | Notebook</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Notebook</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">keep hungry, keep foolish.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/Soaringls" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://blog.dexter.cool/2020/12/31/autonomous-kalman-filter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/sunshine.jpg">
      <meta itemprop="name" content="Dexter">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Notebook">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Introduction of Kalman Filter<a href="https://github.com/Soaringls/blog/tree/note/source/_posts/autonomous/kalman_filter.md" class="post-edit-link" title="Edit this post" rel="noopener" target="_blank"><i class="fa fa-pencil-alt"></i></a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-12-31 19:22:23" itemprop="dateCreated datePublished" datetime="2020-12-31T19:22:23+08:00">2020-12-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-01-08 14:20:19" itemprop="dateModified" datetime="2021-01-08T14:20:19+08:00">2021-01-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/autonomous/" itemprop="url" rel="index"><span itemprop="name">autonomous</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/autonomous/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>The content mainly reference from <a href="https://blog.yongcong.wang/2020/10/29/autonomous/imm-for-prediction/" target="_blank" rel="noopener">yongcongwang’s IMM Prediction</a><br>The Kalman filter which was published by R.E.Kalman in 1960, is a set of mathematical equations that provides an efficient computational (recursive) means to estimate the state of a process, in a way that minimizes the mean of the squared error. <a id="more"></a>The filter is very powerful in several aspects: it supports estimations of past, present, and even future states, and it can do so even when the precise nature of the modeled system is unknown.</p>
<h2 id="Basic-Equations"><a href="#Basic-Equations" class="headerlink" title="Basic Equations"></a>Basic Equations</h2><ul>
<li>overview<br>$$<br>\begin{aligned}<br>  \underset{n \times 1}{X_k} &amp;= \underset{n \times n}{A}\underset{n \times 1}{X_{k-1}} + \underset{n \times b}{B}   \underset{b \times 1}{U_{k-1}} + \underset{n \times 1}{w_{k-1}},(Q)\\<br>  \underset{m \times 1}{Z_k} &amp;= \underset{m \times n}{H}\underset{n \times 1}{X_k} + \underset{m \times 1}{v_{k}},(R)<br>\end{aligned}<br>$$</li>
<li>predict<br>$$<br>\begin{aligned}<br>  \underset{n \times 1}{X_k^{pre}} &amp;= \underset{n \times n}{A} \cdot \underset{n \times 1}{X_{k-1}} + \underset{n \times b}{B} \cdot \underset{b \times 1}{U_{k-1}}\\<br>  \underset{n \times n}{P_k^{pre}} &amp;= \underset{n \times n}{A} \cdot \underset{n \times n}{P_{k-1}} \cdot \underset{n \times n}{A^T} + \underset{n \times n}{Q}<br>\end{aligned}<br>$$</li>
</ul>
<!-- $$
\begin{aligned}
    \underset{n \times n}{P^{pre}_k} will be wrong,it should be write as "\underset{n \times n}{P_k^{pre}}"
\end{aligned}
$$ -->
<ul>
<li>correct<br>$$<br>\begin{aligned}<br>  \mathcal{K_{n \times m}} &amp;= (P^{pre}_kH^T)  \cdot (HP^{pre}_kH^T + R)^{-1} \\<br>  X_k &amp;= X^{pre}_k + \mathcal{K}(Z_k- HX^{pre}_k) \\<br>  P_k &amp;= (I - \mathcal{K}H)P^{pre}_k<br>\end{aligned}<br>$$</li>
</ul>
<h2 id="The-process-to-be-estimated"><a href="#The-process-to-be-estimated" class="headerlink" title="The process to be estimated"></a>The process to be estimated</h2><p>The Kalman filter addressed the general problem of trying to estimate the state $x\in \Re^n$ of a discrete-time controlled process that is governed by the linear stochastic difference equation:<br>$$<br>x_k = Ax_{k-1} + Bu_{k-1} + w_{k-1} \qquad p(w) \sim N(0, Q) \tag{1}<br>$$<br>with a measurement $z \in \Re^m$ that is:<br>$$<br>z_k = Hx_k + v_k \qquad p(v) \sim N(0,R) \tag{2}<br>$$</p>
<ul>
<li>The $n*n$ matrix $A$ is <code>transition matrix</code> which relates the state at the previous time step $k-1$ to the state at the current step $k$, in the absence of either a driving function or process noise. Note that in practice $A$ might change with each time step, but here we assume it is constant.</li>
<li>The $n *1$ matrix $B$ is <code>control matrix</code> which relates the optional control input $u \in \Re^l$ to the state $x$.</li>
<li>The $m *n$ matrix $H$ is <code>measurement matrix</code> which relates the state to the measurement $z_k$. In practice $H$ might change with each time step, but here we also assume it is constant.</li>
<li>The random variable $w_{k-1}$ and $v_k$ represent the process and measurement noise. They are assumed to be independent(of each other), it belongs to gauss-white noise with normal probability distributions. and $Q$ is <code>process noise covariance</code> and $R$ is <code>measurement noise covariance</code>, they might change with each time step, but we assume they are both constant.</li>
</ul>
<h2 id="The-computational-origin-of-the-filter"><a href="#The-computational-origin-of-the-filter" class="headerlink" title="The computational origin of the filter"></a>The computational origin of the filter</h2><p>We define $\hat{x}_k^- \in \Re^n$ to be our <code>priori state</code> estimate at step $k$ given knowledge of the process priori to step $k$ and $\hat{x}_k \in \Re^n$ to be our <code>posteriori state</code>  estimate at step $k$ given measurement $z_k$. we also define $x_k$ is the ground truth, then we can get a <code>priori</code> and a <code>posteriori</code> estimate errors as:<br>$$<br>prio\ estimate\ error: \ e_k^- \equiv x_k - \hat{x}_k^-   \tag{3}<br>$$<br>$$<br>post\ estimate\ error:\ e_k \equiv x_k - \hat{x}_k \tag{4}<br>$$<br>The <code>priori</code> estimate error covariance is:<br>$$<br>P_k^-  = E[e_k^-(e_k^-)^T] \tag{5}<br>$$<br>The <code>posteriori</code> estimate error covariance is:<br>$$<br>P_k = E[e_ke_k^T] \tag{6}<br>$$<br>In deriving the equation for the kalman filter, we begin with the goal of finding an equation that compute an <code>posteriori</code> state estimate $\hat{x}_k$ as a linear combination of the <code>priori</code> estimate $\hat{x}_k^-$ and a weighted difference between an actual measurement $z_k$ and a prediction of the measurement $H\hat{x}_k^-$ as show below:<br>$$<br>\hat{x}_k = \hat{x}_k^- + K(z_k - H\hat{x}_k^-) \tag7<br>$$<br>The difference $(z_k - H\hat{x}_k^-)$ is called the measurement <code>innovation</code> or <code>residual</code>. The residual reflects the discrepency bewteen the predicted measurement $H\hat{x}_k^-$ and the actual measurement $z_k$. A residual of zero means that the two are in complete agreement.<br>The $n*m$ matrix $K$ is chosen to be the <code>gain</code> or <code>blending factor</code> that minimizes the <code>posteriori</code> error covariance in (6).</p>
<p>This minimization can be accomplished by:</p>
<ol>
<li>substituting (7) into the (4) and substituting that into (6);</li>
<li>performing the indicated expectation;</li>
<li>taking the derivative of the trace of the result with respect to $K$;</li>
<li>setting the result equal to $0$ and then solving for $K$.<br>One form of the resulting $K$ that minimized (6) is:</li>
</ol>
<p>$$<br>\begin{aligned}<br>   K_k  &amp;= P_k^-H^T(HP_k^-H^T \ +\ R )^{-1} \\<br>        &amp;= \frac{P_k^-H^T}{HP_k^-H^T \ +\ R }<br>\end{aligned} \tag{8}<br>$$ </p>
<p>Looking at (10) we see that as the measurement error covariance $R \to 0$, the gain $K$ weights the residual more heavily.Specially,<br>$$<br>\lim_{R_k \to 0}K_k = H^{-1} \tag{9}<br>$$<br>On the other hand, as the <code>priori estimate error covariance</code> $P_k^- \to 0$, the gain $K$ weights the residual less heavily.Specially,<br>$$<br>\lim_{P_k^- \to 0}K_k = 0 \tag{10}<br>$$</p>
<p>Another way of thinking about the weighting by $K$ is that as the measurement error covariance $R \to 0$, the actual measurement $z_k$ is <code>more trusted</code>, while the predicted mesaurement $H\hat{x}_k^-$ is <code>less trusted</code>. On the other hand, as the <code>priori estimate error covariance</code> $P_k^- \to 0$, the actual measurement $z_k$ is <code>less trusted</code>, while the predicted measurement $H\hat{x}_k^-$ is <code>more trusted</code>.</p>
<h2 id="The-discrete-Kalman-Filter-Algorithm"><a href="#The-discrete-Kalman-Filter-Algorithm" class="headerlink" title="The discrete Kalman Filter Algorithm"></a>The discrete Kalman Filter Algorithm</h2><p>The kalman filter estimate a process by using a form of feedback control: the filter estimates the process state at some time and then obtains feedback in the form of (noisy) measurement. As such, the equations for the Kalman filter falls into two groups:</p>
<ul>
<li><code>time update</code>(predict) equations;</li>
<li><code>measurement update</code>(correct) equations;</li>
</ul>
<p>The <code>time update</code> equations are responsible for projecting forwar(in time) the current state and error covariance estimates to obtain the <code>prior</code> estimates for the next time step.</p>
<p>The <code>measurement update</code> equations are responsible for the feedback, incorporating a new measurement into the <code>priori estimate</code> to obtain an improved <code>posterori</code> estimate.</p>
<p>The final estimation algorithm resembles that of a <code>predictor-&gt;corrector</code> algorithm for solving numerical problems:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Time Update -----&gt; Measurement Update</span><br><span class="line"> (Predict)             (Correct)</span><br><span class="line">     ^                     |</span><br><span class="line">     |                     |</span><br><span class="line">     -----------------------</span><br></pre></td></tr></table></figure>
<p>The specific equations for the <code>time update(predictor)</code> are:<br>$$<br>\hat{x}_k^- = A\hat{x}_{k-1} + Bu_{k-1} \tag{11}<br>$$<br>$$<br>P_k^- = AP_{k-1}A^T + Q \tag{12}<br>$$<br>where:</p>
<ul>
<li>$\hat{x}_{k-1}$ is the <code>posteriori</code> state from time step $k-1$; </li>
<li>$u_{k-1}$ is the control from time step $k-1$;</li>
<li>$\hat{x}_k^-$ is the <code>priori</code> state from time step $k$;</li>
<li>$P_{k-1}$ is the <code>posterirori</code> estimate error covariance from time step $k-1$;</li>
<li>$P_k^-$ is the <code>priori</code> estimate error covariance from time step $k$;</li>
</ul>
<p>The specific equations for the <code>measurement update(corrector)</code> are:<br>$$<br>K_k = P_k^-H^T \cdot (HP_k^-H^T + R)^{-1} \tag{13}<br>$$<br>$$<br>\hat{x}_k = \hat{x}_k^- + K_k\cdot (z_k - H\hat{x}_k^-) \tag{14}<br>$$<br>$$<br>P_k= (I - K_kH) \cdot P_k^- \tag{15}<br>$$<br>where:</p>
<ul>
<li>$K_k$ is the <code>gain</code> from time step $k$;</li>
<li>$z_k$ is the actual measurement variable from time step $k$;</li>
<li>$\hat{x}_k$ is the <code>posteriori</code> state from time step $k$;</li>
<li>$P_k$ is the <code>posteriori</code> estimate error covariance from time step $k$;</li>
</ul>
<h2 id="Python-of-Kalman-Filter"><a href="#Python-of-Kalman-Filter" class="headerlink" title="Python of Kalman Filter"></a>Python of Kalman Filter</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KalmanFilter</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, A, B, H, Q, R)</span>:</span></span><br><span class="line">        self.A = A</span><br><span class="line">        self.B = B</span><br><span class="line">        self.H = H</span><br><span class="line">        self.Q = Q</span><br><span class="line">        self.R = R</span><br><span class="line"></span><br><span class="line">        self.U = np.zeros((B.shape[<span class="number">1</span>], <span class="number">1</span>))</span><br><span class="line">        self.X = np.zeros((A.shape[<span class="number">0</span>], <span class="number">1</span>))</span><br><span class="line">        self.X_pre = self.X</span><br><span class="line">        self.P = np.zeros(A.shape)</span><br><span class="line">        self.P_pre = self.P</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, A, H)</span>:</span></span><br><span class="line">        self.A = A</span><br><span class="line">        self.X = np.zeros((A.shape[<span class="number">0</span>], <span class="number">1</span>))</span><br><span class="line">        self.B = np.eye(A.shape[<span class="number">0</span>])</span><br><span class="line">        self.U = np.zeros((self.B.shape[<span class="number">1</span>], <span class="number">1</span>))</span><br><span class="line">        self.Q = np.eye(A.shape[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        self.H = H</span><br><span class="line">        self.R = np.eye(H.shape[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        self.X_pre = self.X</span><br><span class="line">        self.P = np.zeros(A.shape)</span><br><span class="line">        self.P_pre = self.P</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">filt</span><span class="params">(self, Z)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        x = A*x + B*u +Q</span></span><br><span class="line"><span class="string">        y = H*x +     R</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.__predict()</span><br><span class="line">        self.__update(Z)</span><br><span class="line">        <span class="keyword">return</span> self.X</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__predict</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        x_next = A*x + B*u</span></span><br><span class="line"><span class="string">        P_next = A*P*AT + Q</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.X_pre = np.dot(self.A, self.X) + np.dot(self.B, self.U)</span><br><span class="line">        self.P_pre = np.dot(np.dot(self.A, self.P), self.A.T) + self.Q</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__update</span><span class="params">(self, Z)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        K = (P_next*HT) * (H*P_next*HT + R).inverse()</span></span><br><span class="line"><span class="string">        x = x_next + K*(z - H*x_next)</span></span><br><span class="line"><span class="string">        P = P_next - K*H*P_next</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        K = np.dot(np.dot(self.P_pre, self.H.T),</span><br><span class="line">                   np.linalg.inv(np.dot(np.dot(self.H, self.P_pre), self.H.T) +</span><br><span class="line">                                 self.R))</span><br><span class="line">        self.X = self.X_pre + np.dot(K, Z - np.dot(self.H, self.X_pre))</span><br><span class="line">        self.P = self.P_pre - np.dot(np.dot(K, self.H), self.P_pre)</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/algorithm/" rel="tag"># algorithm</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/12/04/dairy-note-no-valience-chatting/" rel="prev" title="读书笔记:非暴力沟通">
      <i class="fa fa-chevron-left"></i> 读书笔记:非暴力沟通
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/01/08/coding-several-design-patterns-by-cpp/" rel="next" title="Several Design Patterns By C++">
      Several Design Patterns By C++ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Basic-Equations"><span class="nav-number">1.</span> <span class="nav-text">Basic Equations</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-process-to-be-estimated"><span class="nav-number">2.</span> <span class="nav-text">The process to be estimated</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-computational-origin-of-the-filter"><span class="nav-number">3.</span> <span class="nav-text">The computational origin of the filter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-discrete-Kalman-Filter-Algorithm"><span class="nav-number">4.</span> <span class="nav-text">The discrete Kalman Filter Algorithm</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python-of-Kalman-Filter"><span class="nav-number">5.</span> <span class="nav-text">Python of Kalman Filter</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dexter"
      src="/images/sunshine.jpg">
  <p class="site-author-name" itemprop="name">Dexter</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Soaringls" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Soaringls" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:sxls1992@gmail.com" title="E-Mail → mailto:sxls1992@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dexter</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
